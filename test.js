//imagen firma correo
msg.Imagen_LogoEntel = "<img alt=''width=100% src='data:image/png;base64,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'/>";
//fecha actual para busqueda en sharepoint
const dateFecha = new Date();
let fechaDiaActual = ""
let mesActual = ""
if (dateFecha.getDate() <= 9) {
    fechaDiaActual = "0" + (dateFecha.getDate())
} else {
    fechaDiaActual = dateFecha.getDate()
}
if (dateFecha.getMonth() + 1 <= 9) {
    mesActual = "0" + (dateFecha.getMonth() + 1)
} else {
    mesActual = dateFecha.getMonth() + 1
}

const fechaActual = `${fechaDiaActual}${mesActual}${dateFecha.getFullYear()}`;


var fechaAyer = new Date();
fechaAyer.setDate(fechaAyer.getDate() - 1);

// Obtiene la fecha en formato "dd_Month"
msg.logMigracionDiaAnterior = fechaAyer.toLocaleDateString('es-ES', { day: '2-digit', month: 'long' });
msg.logMigracionDiaAnterior = msg.logMigracionDiaAnterior.replace(' de ', '_'); // Reemplaza "de" con guion bajo



msg.logMigracion = `${dateFecha.getFullYear()}${mesActual}_Migracion.csv`;
msg.logMigracionDiaAnterior = msg.logMigracionDiaAnterior+".csv"
msg.pathLogDiaAnterior = "C:\\Users\\node\\Documents\\CsvMigracion\\" + msg.logMigracionDiaAnterior
msg.pathLogCSV = "C:\\Users\\node\\Documents\\CsvMigracion"
msg.pathEjecucionesCSV = "C:\\Users\\node\\Documents\\CsvMigracion\\Ejecuciones"

//API SHAREPOINT
//Credenciales de SharePoint 
msg.sharepoint_api_clavesecreta = global.get('SharePointCOE_ClaveSecreta')
msg.sharepoint_api_clienteid = global.get('SharePointCOE_ClienteId')
msg.realm = 'db7ae87d-d93d-4431-9e81-1454a045c0cf'
msg.principal = '00000003-0000-0ff1-ce00-000000000000'
//Paremetros Fijos llama API SharePoint Migracion
msg.realmMigracion = 'db7ae87d-d93d-4431-9e81-1454a045c0cf'
msg.principalMigracion = '00000003-0000-0ff1-ce00-000000000000'
msg.sharepoint_api_clienteidMigracion = "c3e79444-b0ff-494f-9375-a200480b8825"
msg.sharepoint_api_clavesecretaMigracion = "omVpUGyqwCe7T4vEHpE83wTRd6Nq6ZtXbnh7BR5yz1A="
msg.url_CarpetaInput = `https://grupoentel.sharepoint.com/sites/CoEAutomatizacinEdCorp/_api/web/GetFolderByServerRelativeUrl('/sites/CoEAutomatizacinEdCorp/Documentos%20compartidos/testPlanesMigracion')/Files?$filter=CheckInComment eq '' and substringof('${fechaActual}', Name) &$top=10&$orderby=TimeLastModified desc&$select=ListItemAllFields/ID,Name,TimeLastModified,CheckInComment`;
msg.url_CarpetaInputMigracion = `https://grupoentel.sharepoint.com/sites/RPASFTP/_api/web/GetFolderByServerRelativeUrl('/sites/RPASFTP/RPA_MisPPaPlan_IVR/Input')/Files?$top=10&$orderby=TimeCreated desc&$filter=CheckInComment eq '' and substringof('${fechaActual}', Name)`

//`https://grupoentel.sharepoint.com/sites/RPASFTP/_api/web/GetFolderByServerRelativeUrl('/sites/RPASFTP/RPA_MisPPaPlan_IVR/Input')/Files?$filter=CheckInComment eq '' and substringof('${fechaActual}', Name)`

//API CAMBIO DE PLAN Migracion
msg.apiIDPlanMigracion = "574f9e27-4abb-aa4f-9525-e33ef620ec51"
msg.contactKeyPlanMigracion = "a679f1a3-a02b-a046-966d-ad16ad4a328a"

//Ruta Log
msg.rutaLog = `https://grupoentel.sharepoint.com/sites/CoEAutomatizacinEdCorp/_api/web/GetFolderByServerRelativeUrl('/sites/CoEAutomatizacinEdCorp/Documentos%20compartidos/testPlanesMigracion')/Files?$filter=Name eq '${msg.logMigracion}'`;
msg.rutaLocal = "C:\\Users\\node\\Documents\\CsvMigracion\\" + msg.logMigracion

//Parametros API Microsoft Graph
//Parametros API Microsoft Graph
msg.Graph_UrlToken = "https://login.microsoftonline.com/db7ae87d-d93d-4431-9e81-1454a045c0cf/oauth2/v2.0/token";
msg.Graph_UserId = "coe_bot_031@entel.cl"
msg.Graph_client_id = global.get('Office365_Api_ClientId');
msg.Graph_client_secret = global.get('Office365_Api_ClientSecret');
msg.Graph_correo_desarrollador = [
    { "emailAddress": { "address": "fabrica_rpa_corp@entel.cl" } }
];
msg.Graph_correo_to = [
    { "emailAddress": { "address": "fabrica_rpa_corp@entel.cl" } },
];
msg.Graph_correo_cc = [
    { "emailAddress": { "address": "fabrica_rpa_corp@entel.cl" } },
];
//imagen firma correo
msg.Imagen_LogoEntel = "<img alt=''width=100% src='data:image/png;base64,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'/>";

return msg;